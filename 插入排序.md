# 插入排序
在冒泡排序和选择排序之后，在本系列中将介绍第三种典型的排序算法－插入排序。插入排序在最佳情况下（best-case）复杂度为O(n),低于复杂度为O(n2)冒泡排序和选择排序。这也是本系列中所介绍的第一种稳定排序算法。

稳定排序是指不改变序列中相同元素的位置。在冒泡和选择排序中，可能会改变相同元素的原位置。你可能会好奇为什么需要关注相同元素的原位置。当对一些简单的值排序时，比如数字或字符串，这就无关紧要。可当我们排序的是带有属性的对象时，就会存在影响，比如对含有`age`属性的`person`对象排序，即使人名相同，但是年龄却有差别。

一些使用交换的排序算法自然而然就不是稳定排序。因为序列中的元素一直在被移动，你无法保证其保持在原位置。插入排序并没有使用交换的方式，而是将每个单一的元素选出后再插入到序列中正确的位置。

插入排序的工作原理是将一个数组分成两个片段，一个已排序片段和一个为排序片段。当然，一开始整个序列都是未排序的。这里的已排序片段在这时被定义为空。我们将首先将一个值添加到已排序片段，这时候已排序数组中就有了一个元素，然后在未排序数组中操作如下：

- 如果该元素应该排在已排序数组的上一个元素之后，那么不做任何操作。
- 如果该元素应该排在已排序数组的上一个元素之前，那么就将该元素移已排序数组，并且将已排序数组的上一个元素后移空出位置
- 将该元素的值与已排序数组中的元素相比较。
- 如果该元素的值大于前一个小于后一个元素，将该元素放在它们中间， 否则继续以上操作，直至遍历完未排序序列。

插入排序解释起来确实有点啰嗦， 可以用个煎蛋的例子来说明，假设以下数组为待排序序列：

`var items = [5,2,6,1,3,9]`

首先将5放入已排序数组中。然后开始操作2，由于5大于2，所以将5向右移动，将2放在第一个位置。如下图所示该处理过程（黄框是已排序数组，白框表示未排序数组）
![image](https://www.nczonline.net/images/wp-content/uploads/2012/09/insertionsort.png)
然后继续处理元素`6`。未排序序列中的每个元素都将执行以上操作直到每个元素都放入期望的位置。JS可以很容易地实现该过程，代码如下：


    function insertionSort(items) {
    var len     = items.length,     // number of items in the array
        value,                      // the value currently being compared
        i,                          // index into unsorted section
        j;                          // index into sorted section

    for (i=0; i < len; i++) {

        // store the current value because it may shift later
        value = items[i];

        /*
         * Whenever the value in the sorted section is greater than the value
         * in the unsorted section, shift all items in the sorted section over
         * by one. This creates space in which to insert the value.
         */
        for (j=i-1; j > -1 && items[j] > value; j--) {
            items[j+1] = items[j];
        }

        items[j+1] = value;
    }

    return items;
    }



外层`for`循环在未排序数组中从前到后移动移动元素，内存循环在已排序数组中从后往前移动元素。内存循环同时负责在比较发生后移动元素。你可以从我的Github上下载源码：[Computer Science in JavaScript](https://github.com/nzakas/computer-science-in-javascript/)

平均复杂度为O(n2)的插入排序效率并不高。在性能上它与选择和冒泡排序相当。这三个排序算法在此作为排序算法的讨论，在实际工作中可能不会用到。在JavaScript中实现排序最好的方法是在试用其他算法前使用自带的`sort()`方法。Chrome的V8引擎在排序十个活着更少的元素时实际是使用插入排序来实现`sort()`方法。
        